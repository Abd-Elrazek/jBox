jQuery(document).ready(function(){new jBox.plugin("Image",{src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:360,imageSize:"contain",imageCounter:!1,imageCounterSeparator:"/",target:window,attach:"[data-jbox-image]",fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"button",closeButton:!0,overlay:!0,animation:"zoomIn",preventDefault:!0,width:"100%",height:"100%",adjustDistance:{top:40,right:5,bottom:40,left:5},_onInit:function(){this.images=this.currentImage={},this.imageZIndex=1,this.attachedElements&&jQuery.each(this.attachedElements,function(t,i){if(i=jQuery(i),!i.data("jBox-image-gallery")){var s=i.attr(this.options.gallery)||"default";!this.images[s]&&(this.images[s]=[]),this.images[s].push({src:i.attr(this.options.src),label:i.attr(this.options.imageLabel)||""}),"title"==this.options.imageLabel&&i.removeAttr("title"),i.data("jBox-image-gallery",s),i.data("jBox-image-id",this.images[s].length-1)}}.bind(this));var t=function(t,i,s,e,o){if(!jQuery("#jBox-image-"+t+"-"+i).length){var n=jQuery("<div/>",{id:"jBox-image-"+t+"-"+i,"class":"jBox-image-container"+(o?" jBox-image-not-found":"")+(e||s?"":" jBox-image-"+t+"-current")}).css({backgroundImage:o?"":'url("'+this.images[t][i].src+'")',backgroundSize:this.options.imageSize,opacity:e?1:0,zIndex:s?0:this.imageZIndex++}).appendTo(this.content);jQuery("<div/>",{id:"jBox-image-label-"+t+"-"+i,"class":"jBox-image-label"+(e?" active":"")}).html(this.images[t][i].label).click(function(){$(this).toggleClass("expanded")}).appendTo(this.imageLabel),!e&&!s&&n.animate({opacity:1},this.options.imageFade)}}.bind(this),i=function(t,i){jQuery(".jBox-image-label.active").removeClass("active expanded"),jQuery("#jBox-image-label-"+t+"-"+i).addClass("active")};this.showImage=function(s){if("open"!=s){var e=this.currentImage.gallery,o=this.currentImage.id+(1*("prev"==s)?-1:1);o=o>this.images[e].length-1?0:0>o?this.images[e].length-1:o}else{var e=this.source.data("jBox-image-gallery"),o=this.source.data("jBox-image-id");jQuery(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:this.images[e].length>1?"block":"none"})}jQuery(".jBox-image-"+e+"-current").length&&jQuery(".jBox-image-"+e+"-current").removeClass("jBox-image-"+e+"-current").animate({opacity:0},"open"==s?0:this.options.imageFade),this.currentImage={gallery:e,id:o},jQuery("#jBox-image-"+e+"-"+o).length?(jQuery("#jBox-image-"+e+"-"+o).addClass("jBox-image-"+e+"-current").css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==s?0:this.options.imageFade),i(e,o)):(this.wrapper.addClass("jBox-image-loading"),jQuery('<img src="'+this.images[e][o].src+'"/>').each(function(){var s=new Image;s.onload=function(){t(e,o,!1),i(e,o),this.wrapper.removeClass("jBox-image-loading")}.bind(this),s.onerror=function(){t(e,o,!1,null,!0),i(e,o),this.wrapper.removeClass("jBox-image-loading")}.bind(this),s.src=this.images[e][o].src}.bind(this))),this.imageCounter&&(this.images[e].length>1?(this.wrapper.addClass("jBox-image-has-counter"),this.imageCounter.find(".jBox-image-counter-all").html(this.images[e].length),this.imageCounter.find(".jBox-image-counter-current").html(o+1)):this.wrapper.removeClass("jBox-image-has-counter"));var n=o+1;n=n>this.images[e].length-1?0:0>n?this.images[e].length-1:n,!jQuery("#jBox-image-"+e+"-"+n).length&&jQuery('<img src="'+this.images[e][n].src+'"/>').each(function(){var i=new Image;i.onload=function(){t(e,n,!0)}.bind(this),i.onerror=function(){t(e,n,!0,null,!0)}.bind(this),i.src=this.images[e][n].src}.bind(this))}},_onCreated:function(){this.imageLabel=jQuery("<div/>",{"class":"jBox-image-label-container"}).appendTo(this.wrapper),this.imageLabel.append(jQuery("<div/>",{"class":"jBox-image-pointer-prev",click:function(){this.showImage("prev")}.bind(this)})).append(jQuery("<div/>",{"class":"jBox-image-pointer-next",click:function(){this.showImage("next")}.bind(this)})),this.options.imageCounter&&(this.imageCounter=jQuery("<div/>",{"class":"jBox-image-counter-container"}).appendTo(this.wrapper),this.imageCounter.append(jQuery("<span/>",{"class":"jBox-image-counter-current"})).append(jQuery("<span/>").html(this.options.imageCounterSeparator)).append(jQuery("<span/>",{"class":"jBox-image-counter-all"})))},_onOpen:function(){jQuery(document).on("keyup.jBox-Image-"+this.id,function(t){37==t.keyCode&&this.showImage("prev"),39==t.keyCode&&this.showImage("next")}.bind(this)),this.showImage("open")},_onClose:function(){jQuery(document).off("keyup.jBox-Image-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}})});
